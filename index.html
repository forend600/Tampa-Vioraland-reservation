<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<title>Ø¹Ù‚Ø¯ Ø¥ÙŠØ¬Ø§Ø± Ù…Ù†ØªØ¬Ø¹</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="theme-color" content="#2980b9">
Â  <link rel="manifest" href="manifest.json">
<script>
Â  if ('serviceWorker' in navigator) {
Â  Â  navigator.serviceWorker.register('service-worker.js');
Â  }
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

<style>
  *, *::before, *::after {
  box-sizing: border-box;
}
:root{ --brand-blue:#2980b9; }
body{
Â  font-family:'Times New Roman', Arial, Tahoma, sans-serif;
Â  direction:rtl; margin:0; padding:0; background:#fdf5e6; text-align:right;
}
.container{
Â  max-width:800px; margin:16px 50px; padding:20px; background:#fff; /* (ØªØ¹Ø¯ÙŠÙ„) This adds side margin */
Â  border-radius:14px; border:3px solid var(--brand-blue);
}
h1{text-align:center; color:#2c3e50; font-size:26px;}
.title-underline{width:140px; height:3px; background:var(--brand-blue); margin:6px auto 12px; border-radius:2px;}
.booking-number{color:#e53935; font-weight:bold; font-size:22px; text-align:center;}
.info-row{margin:6px 0;}
.dates-block{background:#f9f9f9; border:1px solid #ccc; border-radius:8px; padding:10px; margin:12px 0; font-size:15px;}
.terms li{margin:6px 0;}
.season-note{color:#c62828; font-weight:bold;}
.contract-footer{text-align:center; font-size:12px; color:#555; margin-top:18px;}
form{
Â  max-width:520px; margin: 18px 10px; background:#fff; /* (ØªØ¹Ø¯ÙŠÙ„) This adds side margin */
Â  padding:16px; border-radius:10px; box-shadow:0 4px 10px rgba(0,0,0,.07);
}
label{display:block; margin-top:12px; font-weight:bold; text-align: right; direction: rtl;} /* (ØªØ¹Ø¯ÙŠÙ„) This fixes colon alignment */
input,select{width:100%; padding:10px; margin-top:6px; border-radius:8px; border:1px solid #ccc; text-align: right;}
/* === (ØªØ¹Ø¯ÙŠÙ„) CSS: ØªÙ… ØªØºÙŠÙŠØ± "flex-start" Ø¥Ù„Ù‰ "flex-end" Ù„Ø¥ØµÙ„Ø§Ø­ Ù…Ø­Ø§Ø°Ø§Ø© Ø§Ù„Ù‡Ø§ØªÙ === */
.options-row{display:flex; flex-wrap:wrap; justify-content: flex-end; gap:6px; margin-top:16px;}
.option-block{display:flex; align-items:center; gap:6px;}
.option-block input[type="checkbox"] { width: auto; margin-top: 0; }
.option-block label { margin-top: 0; font-weight: normal; }

button{padding:12px; background:#27ae60; color:#fff; border:none; border-radius:10px; cursor:pointer; width:100%; margin-top:16px;}
.btn{background:var(--brand-blue); color:#fff; border:none; padding:12px 16px; border-radius:10px; cursor:pointer;}
.btn-whatsapp{background:#25d366;}
.actions{display:flex; flex-wrap:wrap; gap:10px; justify-content:center; margin-top:10px;}
@media print {.container{border:3px solid var(--brand-blue)!important;}}
</style>
</head>
<body>

<form id="bookingForm">
Â  <label>Ø§Ø®ØªØ± Ø§Ù„Ù…Ù†ØªØ¬Ø¹:</label>
Â  <select id="resortSelect" required>
Â  Â  <option value="" disabled selected>Ø§Ø®ØªØ± Ø§Ù„Ù…Ù†ØªØ¬Ø¹</option>
Â  Â  <option value="Ù…Ù†ØªØ¬Ø¹ ØªØ§Ù…Ø¨Ø§">Ù…Ù†ØªØ¬Ø¹ ØªØ§Ù…Ø¨Ø§</option>
Â  Â  <option value="Ù…Ù†ØªØ¬Ø¹ ÙÙŠÙˆØ±Ø§Ù„Ø§Ù†Ø¯">Ù…Ù†ØªØ¬Ø¹ ÙÙŠÙˆØ±Ø§Ù„Ø§Ù†Ø¯</option>
Â  </select>

  <div class="options-row" style="margin-top: 10px; justify-content: flex-end;">
    <div class="option-block">
      <input type="checkbox" id="bookBothResorts"><label for="bookBothResorts">Ø­Ø¬Ø² Ø§Ù„Ù…Ù†ØªØ¬Ø¹ÙŠÙ† Ù„Ù†ÙØ³ Ø§Ù„Ø¹Ù…ÙŠÙ„</label>
    </div>
  </div>

Â  <label>Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ£Ø¬Ø±:</label>
Â  <input type="text" id="customerName" required>

Â  <label>Ø§Ù„Ø¹Ø±Ø¨ÙˆÙ† (Ø±ÙŠØ§Ù„):</label>
Â  <input type="number" id="deposit" min="0" required>

Â  <label>Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ (Ø±ÙŠØ§Ù„):</label>
Â  <input type="number" id="remaining" min="0" required>

Â  <label>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø­Ø¬Ø²:</label>
Â  <input type="date" id="bookingDate" required>

Â  <div class="options-row">
Â  Â  <div class="option-block">
Â  Â  Â  <input type="checkbox" id="overnight"><label for="overnight">Ù…Ø¨ÙŠØª</label>
Â  Â  </div>
Â  Â  <div class="option-block">
Â  Â  Â  <input type="checkbox" id="noPool"><label for="noPool">Ø¨Ø¯ÙˆÙ† Ù…Ø³Ø¨Ø­</label>
Â  Â  </div>
    <div class="option-block">
      <input type="checkbox" id="winterPeriod"><label for="winterPeriod">ÙØªØ±Ø© Ø§Ù„Ø´ØªØ§Ø¡</label>
    </div>
Â  Â  <div class="option-block" id="tampaOptions" style="display:none;">
Â  Â  Â  <span>Ø®Ø§Øµ Ø¨Ù…Ù†ØªØ¬Ø¹ ØªØ§Ù…Ø¨Ø§:</span>
Â  Â  Â  <input type="checkbox" id="summer"><label for="summer">ØµÙŠÙ</label>
Â  Â  Â  <input type="checkbox" id="winter"><label for="winter">Ø´ØªØ§Ø¡</label>
Â  Â  </div>
Â  </div>
Â  <button type="submit">Ø¹Ø±Ø¶ Ø§Ù„Ø¹Ù‚Ø¯</button>
</form>

<div id="contract" class="container" style="display:none;">
Â  <h1 id="contractTitle"></h1>
Â  <div class="title-underline"></div>
Â  <div id="bookingNumber" class="booking-number"></div>
Â  <div id="introTextContainer"></div>
Â  <div id="bookingInfo"></div>
Â  <hr>
Â  <div class="terms">
Â  Â  <h3>Ø§Ù„Ø´Ø±ÙˆØ·:</h3>
Â  Â  <ul id="termsList"></ul>
Â  Â  <p><strong>Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø§Ù„Ø±Ø¯ Ø¨ÙƒÙ„Ù…Ø© Ù…ÙˆØ§ÙÙ‚</strong></p>
Â  </div>
Â  <div id="contractFooter" class="contract-footer"></div>

Â  <div class="actions">
Â  Â  <button id="saveAllBtn" class="btn">Ø­ÙØ¸ ÙˆÙ…Ø´Ø§Ø±ÙƒØ© (ÙˆØ§ØªØ³Ø§Ø¨)</button>
Â  Â  <button id="calendarICSBtn" class="btn">Ø£Ø¶Ù Ø¥Ù„Ù‰ Ø§Ù„ØªÙ‚ÙˆÙŠÙ…</button>
Â  </div>
</div>

<script>
const form=document.getElementById('bookingForm');
const contract=document.getElementById('contract');
const contractTitle=document.getElementById('contractTitle');
const bookingNumberEl=document.getElementById('bookingNumber');
const introTextContainer=document.getElementById('introTextContainer');
const bookingInfo=document.getElementById('bookingInfo');
const termsList=document.getElementById('termsList');
const contractFooter=document.getElementById('contractFooter');

const saveAllBtn=document.getElementById('saveAllBtn');
const calendarICSBtn=document.getElementById('calendarICSBtn'); 

const resortSelect = document.getElementById('resortSelect');
const tampaOptions = document.getElementById('tampaOptions');

const bookBothResorts = document.getElementById('bookBothResorts');

const overnight=document.getElementById('overnight');
const noPool=document.getElementById('noPool');
const winterPeriod=document.getElementById('winterPeriod');
const summer=document.getElementById('summer');
const winter=document.getElementById('winter');

summer.addEventListener('change',()=>{if(summer.checked)winter.checked=false;});
winter.addEventListener('change',()=>{if(winter.checked)summer.checked=false;});

function updateResortOptionsVisibility() {
  const isTampaSelected = (resortSelect.value === 'Ù…Ù†ØªØ¬Ø¹ ØªØ§Ù…Ø¨Ø§');
  const isBothBooked = bookBothResorts.checked;

  if (isBothBooked) {
    resortSelect.removeAttribute('required'); 
  } else {
    resortSelect.setAttribute('required', 'true'); 
  }

  if (isTampaSelected || isBothBooked) {
    tampaOptions.style.display = 'flex';
  } else {
    tampaOptions.style.display = 'none';
    summer.checked = false;
    winter.checked = false;
  }
}

resortSelect.addEventListener('change', updateResortOptionsVisibility);
bookBothResorts.addEventListener('change', updateResortOptionsVisibility);

function formatDate(d){
 const days=["Ø§Ù„Ø£Ø­Ø¯","Ø§Ù„Ø¥Ø«Ù†ÙŠÙ†","Ø§Ù„Ø«Ù„Ø§Ø«Ø§Ø¡","Ø§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡","Ø§Ù„Ø®Ù…ÙŠØ³","Ø§Ù„Ø¬Ù…Ø¹Ø©","Ø§Ù„Ø³Ø¨Øª"];
 const months=["ÙŠÙ†Ø§ÙŠØ±","ÙØ¨Ø±Ø§ÙŠØ±","Ù…Ø§Ø±Ø³","Ø£Ø¨Ø±ÙŠÙ„","Ù…Ø§ÙŠÙˆ","ÙŠÙˆÙ†ÙŠÙˆ","ÙŠÙˆÙ„ÙŠÙˆ","Ø£ØºØ³Ø·Ø³","Ø³Ø¨ØªÙ…Ø¨Ø±","Ø£ÙƒØªÙˆØ¨Ø±","Ù†ÙˆÙÙ…Ø¨Ø±","Ø¯ÙŠØ³Ù…Ø¨Ø±"];
 return `${days[d.getDay()]} ${d.getDate()} ${months[d.getMonth()]} ${d.getFullYear()}`;
}
function getBaseTerms(){
  return [
    "Ø§Ù„Ø¹Ø±Ø¨ÙˆÙ† ØºÙŠØ± Ù…Ø³ØªØ±Ø¯",
    "Ø§Ù„Ù…Ù†ØªØ¬Ø¹ ØºÙŠØ± Ù…Ø³Ø¤ÙˆÙ„ Ø¹Ù† ÙÙ‚Ø¯Ø§Ù† Ø§Ù„Ø£ØºØ±Ø§Ø¶ Ø§Ù„Ø´Ø®ØµÙŠØ©",
    "ÙÙŠ Ø­Ø§Ù„ Ø§Ù„Ø£Ø¶Ø±Ø§Ø± Ø§Ù„Ù…Ø§Ø¯ÙŠØ© ÙŠØªØ­Ù…Ù„ Ø§Ù„Ù…Ø³ØªØ£Ø¬Ø± ÙƒØ§ÙØ© Ø§Ù„ØªÙƒØ§Ù„ÙŠÙ",
    "ÙŠÙ…Ù†Ø¹ Ø§Ù„ØªØ¯Ø®ÙŠÙ† Ø¯Ø§Ø®Ù„ ØºØ±Ù ÙˆØµØ§Ù„Ø§Øª Ø§Ù„Ù…Ù†ØªØ¬Ø¹ ğŸš­",
    "ÙŠØ¬Ø¨ Ø¥Ø¨Ù„Ø§Øº Ø§Ù„Ø­Ø§Ø±Ø³ ÙˆÙ‚Øª Ø§Ù„Ø®Ø±ÙˆØ¬ Ù„Ø¥Ø®Ù„Ø§Ø¡ Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ÙŠØ©",
    "Ø§Ù„Ø§Ù„ØªØ²Ø§Ù… Ø¨Ø£ÙˆÙ‚Ø§Øª Ø§Ù„Ø¯Ø®ÙˆÙ„ ÙˆØ§Ù„Ø®Ø±ÙˆØ¬ Ø§Ù„Ù…Ø­Ø¯Ø¯Ø©"
  ];
}
function getSeasonTerms(){
  const t=[];
  if(summer.checked)t.push({text:"Ø§Ù„Ù…Ù„Ø¹Ø¨ Ø§Ù„ØµØ§Ø¨ÙˆÙ†ÙŠ Ù„Ù„Ø£Ø·ÙØ§Ù„ ÙˆÙŠØªØ­Ù…Ù„ Ø§Ù„Ù…Ø³ØªØ£Ø¬Ø± Ø£ÙŠ ØªÙ„ÙÙŠØ§Øª ÙÙŠ Ø§Ù„Ù…Ù„Ø¹Ø¨ Ø§Ù„ØµØ§Ø¨ÙˆÙ†ÙŠ",className:"season-note"});
  if(winter.checked)t.push({text:"ÙŠØ±Ø¬Ù‰ Ø¹Ø¯Ù… Ø¥Ø´Ø¹Ø§Ù„ Ø§Ù„Ù†Ø§Ø± Ø¯Ø§Ø®Ù„ Ø§Ù„Ø®ÙŠÙ…Ø© Ø£Ùˆ Ø¹Ù„Ù‰ Ø§Ù„Ø²ÙŠÙ„",className:"season-note"});
  return t;
}
function renderTerms(){
  termsList.innerHTML="";
  getBaseTerms().forEach(t=>{
    const li=document.createElement('li');li.textContent=t;termsList.appendChild(li);
  });
  getSeasonTerms().forEach(t=>{
    const li=document.createElement('li');li.className=t.className;li.textContent=t.text;termsList.appendChild(li);
  });
}
function formatDateForCal(d){
 const y=d.getFullYear(),m=String(d.getMonth()+1).padStart(2,'0'),da=String(d.getDate()).padStart(2,'0');
 return `${y}${m}${da}`;
}

// === (Ø¬Ø¯ÙŠØ¯) JavaScript: Ø£Ø¶Ù Ù‡Ø°Ù‡ Ø§Ù„ÙˆØ¸ÙŠÙØ© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© ===
function formatDateTimeForGoogle(d) {
  const y = d.getFullYear();
  const m = String(d.getMonth() + 1).padStart(2, '0');
  const da = String(d.getDate()).padStart(2, '0');
  const h = String(d.getHours()).padStart(2, '0');
  const min = String(d.getMinutes()).padStart(2, '0');
  return `${y}${m}${da}T${h}${min}00`;
}

form.addEventListener('submit',e=>{
  e.preventDefault();

  let resort;
  if (bookBothResorts.checked) {
    resort = "Ù…Ù†ØªØ¬Ø¹ (ØªØ§Ù…Ø¨Ø§ ÙˆÙÙŠÙˆØ±Ø§Ù„Ø§Ù†Ø¯)";
  } else {
    resort = resortSelect.value;
  }
  
  const name=document.getElementById('customerName').value;
  const dep=document.getElementById('deposit').value;
  const rem=document.getElementById('remaining').value;
  const date=new Date(document.getElementById('bookingDate').value+"T00:00:00");

  let hours;
  if (winterPeriod.checked) {
    if (overnight.checked) {
      hours = "Ù…Ù† Ù¢ Ù…Ø³Ø§Ø¡Ù‹ Ø¥Ù„Ù‰ Ù¡Ù  ØµØ¨Ø§Ø­Ù‹Ø§"; 
    } else {
      hours = "Ù…Ù† Ù¢ Ù…Ø³Ø§Ø¡Ù‹ Ø¥Ù„Ù‰ Ù¢ ØµØ¨Ø§Ø­Ù‹Ø§"; 
    }
  } else {
    hours = `Ù…Ù† Ù£ Ù…Ø³Ø§Ø¡Ù‹ Ø¥Ù„Ù‰ ${overnight.checked ? "Ù¡Ù¡ ØµØ¨Ø§Ø­Ù‹Ø§" : "Ù¦ ØµØ¨Ø§Ø­Ù‹Ø§"}`;
  }
  
  const hoursColor = overnight.checked ? "red" : "green";
  
  const today=formatDate(new Date());
  
  // === (ØªØ¹Ø¯ÙŠÙ„) JavaScript: Ù…Ù†Ø·Ù‚ Ø±Ù‚Ù… Ø§Ù„Ø­Ø¬Ø² Ø§Ù„Ù…Ø­Ø¯Ø« ===
  let bookingNumber;
  if (bookBothResorts.checked) {
    bookingNumber = "933";
  } else {
    let resortKeyForBooking = resortSelect.value;
    bookingNumber = (resortKeyForBooking === "Ù…Ù†ØªØ¬Ø¹ ØªØ§Ù…Ø¨Ø§" || resortKeyForBooking === "") ? "0117" : "201";
  }

  contractTitle.textContent=`Ø¹Ù‚Ø¯ Ø¥ÙŠØ¬Ø§Ø± ${resort}`;
  bookingNumberEl.textContent=`Ø±Ù‚Ù… Ø§Ù„Ø­Ø¬Ø²: ${bookingNumber}`;
  introTextContainer.innerHTML=`<p style="text-align:center;font-size:17px;">Ø£ÙØ¨Ø±Ù… Ù‡Ø°Ø§ Ø§Ù„Ø¹Ù‚Ø¯ Ø¨ÙŠÙ† Ø§Ù„Ø·Ø±ÙÙŠÙ†:<br>Ø§Ù„Ø·Ø±Ù Ø§Ù„Ø£ÙˆÙ„: ${resort}<br>ÙˆØ§Ù„Ø·Ø±Ù Ø§Ù„Ø«Ø§Ù†ÙŠ: ${name}<br>ÙˆØ°Ù„Ùƒ ÙˆÙÙ‚Ù‹Ø§ Ù„Ù„Ø´Ø±ÙˆØ· ÙˆØ§Ù„Ø£Ø­ÙƒØ§Ù… Ø§Ù„Ù…ÙˆØ¶Ø­Ø© Ø£Ø¯Ù†Ø§Ù‡.</p>`;
  
  bookingInfo.innerHTML=`<div class="info-row"><b>Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ£Ø¬Ø±:</b> ${name}</div>
  <div class="info-row"><b>Ø§Ù„Ø¹Ø±Ø¨ÙˆÙ†:</b> ${dep} Ø±ÙŠØ§Ù„</div>
  <div class="info-row"><b>Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ:</b> ${rem} Ø±ÙŠØ§Ù„</div>
  <div class="info-row"><b>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø­Ø¬Ø²:</b> ${formatDate(date)}</div>
  <div class="info-row" style="color: ${hoursColor}; font-weight: bold;"><b>Ø³Ø§Ø¹Ø§Øª Ø§Ù„Ø­Ø¬Ø²:</b> ${hours}</div>
  ${overnight.checked ? 
    `<div class="info-row" style="color: red; font-weight: bold; margin-top: 10px;"><b>ÙŠØ´Ù…Ù„ Ù…Ø¨ÙŠØª</b></div>` : 
    `<div class="info-row" style="color: green; font-weight: bold; margin-top: 10px;"><b>Ø¨Ø¯ÙˆÙ† Ù…Ø¨ÙŠØª</b></div>`
  }
  ${noPool.checked ? 
    `<div class="info-row" style="color: red; font-weight: bold;"><b>Ø¨Ø¯ÙˆÙ† Ù…Ø³Ø¨Ø­</b></div>` : 
    `<div class="info-row" style="color: green; font-weight: bold;"><b>ÙŠØ´Ù…Ù„ Ù…Ø³Ø¨Ø­</b></div>`
  }`;
  
  renderTerms();
  contractFooter.innerHTML=`ØªØ§Ø±ÙŠØ® ØªØ­Ø±ÙŠØ± Ø§Ù„Ø¹Ù‚Ø¯: ${today}<br>ØªÙ… Ø¥Ø¹Ø¯Ø§Ø¯ Ù‡Ø°Ø§ Ø§Ù„Ø¹Ù‚Ø¯ Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠÙ‹Ø§ â€” ${resort}`;
  contract.style.display="block";
});

  // --- ÙˆØ¸ÙŠÙØ© Ø²Ø± Ø§Ù„Ø­ÙØ¸ ÙˆØ§Ù„Ù…Ø´Ø§Ø±ÙƒØ© (ØµÙˆØ±Ø© + ÙˆØ§ØªØ³Ø§Ø¨) ---
  saveAllBtn.onclick = function() {
    
    let resort;
    let resortKeyForInfo; 
    if (bookBothResorts.checked) {
      resort = "Ù…Ù†ØªØ¬Ø¹ (ØªØ§Ù…Ø¨Ø§ ÙˆÙÙŠÙˆØ±Ø§Ù„Ø§Ù†Ø¯)";
      resortKeyForInfo = "Ù…Ù†ØªØ¬Ø¹ ØªØ§Ù…Ø¨Ø§"; 
    } else {
      resort = resortSelect.value;
      resortKeyForInfo = resortSelect.value;
    }

    const name = document.getElementById('customerName').value;
    const dep = document.getElementById('deposit').value;
    const rem = document.getElementById('remaining').value;
    const date = new Date(document.getElementById('bookingDate').value + "T00:00:00");
    const today = formatDate(new Date());
    
    // === (ØªØ¹Ø¯ÙŠÙ„) JavaScript: Ù…Ù†Ø·Ù‚ Ø±Ù‚Ù… Ø§Ù„Ø­Ø¬Ø² Ø§Ù„Ù…Ø­Ø¯Ø« ===
    let bookingNumber;
    if (bookBothResorts.checked) {
      bookingNumber = "933";
    } else {
      bookingNumber = (resortKeyForInfo === "Ù…Ù†ØªØ¬Ø¹ ØªØ§Ù…Ø¨Ø§" || resortKeyForInfo === "") ? "0117" : "201";
    }
    
    let hours;
    if (winterPeriod.checked) {
        hours = overnight.checked ? "Ù…Ù† Ù¢ Ù…Ø³Ø§Ø¡Ù‹ Ø¥Ù„Ù‰ Ù¡Ù  ØµØ¨Ø§Ø­Ù‹Ø§" : "Ù…Ù† Ù¢ Ù…Ø³Ø§Ø¡Ù‹ Ø¥Ù„Ù‰ Ù¢ ØµØ¨Ø§Ø­Ù‹Ø§";
    } else {
        hours = `Ù…Ù† Ù£ Ù…Ø³Ø§Ø¡Ù‹ Ø¥Ù„Ù‰ ${overnight.checked ? "Ù¡Ù¡ ØµØ¨Ø§Ø­Ù‹Ø§" : "Ù¦ ØµØ¨Ø§Ø­Ù‹Ø§"}`;
    }

    // 1. ÙˆØ¸ÙŠÙØ© Ø­ÙØ¸ Ø§Ù„ØµÙˆØ±Ø©
    document.querySelector('.actions').style.display = 'none'; 
    html2canvas(contract, { scale: 2, useCORS: true }).then(canvas => {
      const link = document.createElement('a');
      link.download = `${name}.png`;
      link.href = canvas.toDataURL('image/png');
      link.click();
      document.querySelector('.actions').style.display = 'flex'; 

      // 2. ÙˆØ¸ÙŠÙØ© ÙˆØ§ØªØ³Ø§Ø¨
      const info={
        "Ù…Ù†ØªØ¬Ø¹ ØªØ§Ù…Ø¨Ø§":{phone:"0567863628",location:"https://maps.app.goo.gl/UJXsVpU2Y6TVY4vB9"},
        "Ù…Ù†ØªØ¬Ø¹ ÙÙŠÙˆØ±Ø§Ù„Ø§Ù†Ø¯":{phone:"0567863628",location:"https://maps.app.goo.gl/LwcejftXAfbTZvtMA"},
        "":{phone:"0567863628",location:"http://googleusercontent.com/maps/google.com/0"} 
      }[resortKeyForInfo]; 
      const msg=[
        `Ø¹Ù‚Ø¯ Ø¥ÙŠØ¬Ø§Ø± ${resort}`, 
        `Ø±Ù‚Ù… Ø§Ù„Ø­Ø¬Ø²: ${bookingNumber}`,
        `Ø§Ù„Ù…Ø³ØªØ£Ø¬Ø±: ${name}`,
        `Ø§Ù„ØªØ§Ø±ÙŠØ®: ${formatDate(date)}`,
        `Ø§Ù„ÙˆÙ‚Øª: ${hours}`, 
        `Ø§Ù„Ø¹Ø±Ø¨ÙˆÙ†: ${dep} Ø±ÙŠØ§Ù„`,
        `Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ: ${rem} Ø±ÙŠØ§Ù„`,
        overnight.checked?"ÙŠØ´Ù…Ù„ Ù…Ø¨ÙŠØª âœ…":"Ø¨Ø¯ÙˆÙ† Ù…Ø¨ÙŠØª",
        noPool.checked ? "Ø¨Ø¯ÙˆÙ† Ù…Ø³Ø¨Ø­ âŒ" : "ÙŠØ´Ù…Ù„ Ù…Ø³Ø¨Ø­ âœ…",
        bookBothResorts.checked ? "ØªÙ… Ø­Ø¬Ø² Ø§Ù„Ù…Ù†ØªØ¬Ø¹ÙŠÙ† âœ…" : "", 
        "",
        "Ø§Ù„Ø´Ø±ÙˆØ·:",
        ...getBaseTerms(),
        ...getSeasonTerms().map(x=>x.text),
        "",
        `ğŸ“ Ø±Ù‚Ù… Ø§Ù„Ø­Ø§Ø±Ø³: ${info.phone}`,
        `ğŸ“ Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ù…Ù†ØªØ¬Ø¹: ${info.location}`,
        "",
        `ØªØ§Ø±ÙŠØ® ØªØ­Ø±ÙŠØ± Ø§Ù„Ø¹Ù‚Ø¯: ${today}`,
        `ØªÙ… Ø¥Ø¹Ø¯Ø§Ø¯ Ù‡Ø°Ø§ Ø§Ù„Ø¹Ù‚Ø¯ Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠÙ‹Ø§ â€” ${resort}`, 
        "Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø§Ù„Ø±Ø¯ Ø¨ÙƒÙ„Ù…Ø©: Ù…ÙˆØ§ÙÙ‚"
      ].join('\n');
      window.open(`https://wa.me/?text=${encodeURIComponent(msg)}`,'_blank');
    });
  };

  // --- (ØªØ¹Ø¯ÙŠÙ„) ÙˆØ¸ÙŠÙØ© Ø²Ø± Ø§Ù„ØªÙ‚ÙˆÙŠÙ… (Ù„Ø­Ø¬Ø² ÙŠÙˆÙ… ÙƒØ§Ù…Ù„) ---
Â  calendarICSBtn.onclick = () => {
Â  Â Â 
Â  Â  let resort;
Â  Â  let resortKeyForInfo;
Â  Â  if (bookBothResorts.checked) {
Â  Â  Â  resort = "Ù…Ù†ØªØ¬Ø¹ (ØªØ§Ù…Ø¨Ø§ ÙˆÙÙŠÙˆØ±Ø§Ù„Ø§Ù†Ø¯)";
Â  Â  Â  resortKeyForInfo = "Ù…Ù†ØªØ¬Ø¹ ØªØ§Ù…Ø¨Ø§";Â 
Â  Â  } else {
Â  Â  Â  resort = resortSelect.value;
Â  Â  Â  resortKeyForInfo = resortSelect.value;
Â  Â  }

Â  Â  const name = document.getElementById('customerName').value;
Â  Â  const dep = document.getElementById('deposit').value;
Â  Â  const rem = document.getElementById('remaining').value;
Â  Â Â 
Â  Â  let bookingNumber;
Â  Â  if (bookBothResorts.checked) {
Â  Â  Â  bookingNumber = "933";
Â  Â  } else {
Â  Â  Â  bookingNumber = (resortKeyForInfo === "Ù…Ù†ØªØ¬Ø¹ ØªØ§Ù…Ø¨Ø§" || resortKeyForInfo === "") ? "0117" : "201";
Â  Â  }

Â  Â  // 1. Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø¹Ù†ÙˆØ§Ù†
Â  Â  let title = `${name} ${dep}-${rem}`;Â 
    if (bookBothResorts.checked) title += " (Ø§Ù„Ù…Ù†ØªØ¬Ø¹ÙŠÙ†)";
Â  Â  if (overnight.checked) title += " (Ù…Ø¨ÙŠØª)";Â 
Â  Â  if (noPool.checked) title += " (Ø¨Ø¯ÙˆÙ† Ù…Ø³Ø¨Ø­)";Â 
Â  Â  if (winterPeriod.checked) title += " (ÙØªØ±Ø© Ø´ØªÙˆÙŠØ©)";

Â  Â  // 2. === (ØªØ¹Ø¯ÙŠÙ„) Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„ØªÙˆØ§Ø±ÙŠØ® Ù„ÙŠÙˆÙ… ÙƒØ§Ù…Ù„ ===
    const baseDate = new Date(document.getElementById('bookingDate').value+"T00:00:00");
Â  Â  const startDateString = formatDateForCal(baseDate); // e.g. 20251125
Â  Â  const nextDay = new Date(baseDate.getTime() + 86400000);Â 
    const endDateString = formatDateForCal(nextDay); // e.g. 20251126
Â  Â Â 
Â  Â  // 3. Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„ØªÙØ§ØµÙŠÙ„ (Ù…Ø§ Ø²Ø§Ù„Øª ØªØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø§Ù„Ø£ÙˆÙ‚Ø§Øª Ø§Ù„ØµØ­ÙŠØ­Ø©)
    let hours;
    if (winterPeriod.checked) {
      if (overnight.checked) {
        hours = "Ù…Ù† Ù¢ Ù…Ø³Ø§Ø¡Ù‹ Ø¥Ù„Ù‰ Ù¡Ù  ØµØ¨Ø§Ø­Ù‹Ø§"; 
      } else {
        hours = "Ù…Ù† Ù¢ Ù…Ø³Ø§Ø¡Ù‹ Ø¥Ù„Ù‰ Ù¢ ØµØ¨Ø§Ø­Ù‹Ø§"; 
      }
    } else {
      hours = `Ù…Ù† Ù£ Ù…Ø³Ø§Ø¡Ù‹ Ø¥Ù„Ù‰ ${overnight.checked ? "Ù¡Ù¡ ØµØ¨Ø§Ø­Ù‹Ø§" : "Ù¦ ØµØ¨Ø§Ø­Ù‹Ø§"}`;
    }
Â  Â  const allTerms = [...getBaseTerms(), ...getSeasonTerms().map(x => x.text)].join('\n- ');
Â  Â  const details = [
Â  Â  Â  `Ø§Ù„Ù…Ù†ØªØ¬Ø¹: ${resort}`,Â 
Â  Â  Â  `Ø±Ù‚Ù… Ø§Ù„Ø­Ø¬Ø²: ${bookingNumber}`,
Â  Â  Â  `Ø§Ù„ØªØ§Ø±ÙŠØ®: ${formatDate(baseDate)}`,
Â  Â  Â  `Ø§Ù„Ø¹Ø±Ø¨ÙˆÙ†: ${dep} Ø±ÙŠØ§Ù„`,
Â  Â  Â  `Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ: ${rem} Ø±ÙŠØ§Ù„`,
Â  Â  Â  overnight.checked ? "ÙŠØ´Ù…Ù„ Ù…Ø¨ÙŠØª âœ…" : "Ø¨Ø¯ÙˆÙ† Ù…Ø¨ÙŠØª",
Â  Â  Â  noPool.checked ? "Ø¨Ø¯ÙˆÙ† Ù…Ø³Ø¨Ø­ âŒ" : "ÙŠØ´Ù…Ù„ Ù…Ø³Ø¨Ø­ âœ…",
Â  Â  Â  `Ø³Ø§Ø¹Ø§Øª Ø§Ù„Ø­Ø¬Ø²: ${hours}`,Â // Ù„Ø§ ÙŠØ²Ø§Ù„ ÙŠØ¸Ù‡Ø± Ø§Ù„ÙˆÙ‚Øª Ø§Ù„ØµØ­ÙŠØ­ Ù‡Ù†Ø§
Â  Â  Â  "",
Â  Â  Â  "Ø§Ù„Ø´Ø±ÙˆØ·:",
Â  Â  Â  `- ${allTerms}`
Â  Â  ].join('\n');Â 

Â  Â  // 4. Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ù…ÙˆÙ‚Ø¹
Â  Â  const resortLocation = {
Â  Â  Â  "Ù…Ù†ØªØ¬Ø¹ ØªØ§Ù…Ø¨Ø§": "http://googleusercontent.com/maps/google.com/2",
Â  Â  Â  "Ù…Ù†ØªØ¬Ø¹ ÙÙŠÙˆØ±Ø§Ù„Ø§Ù†Ø¯": "http://googleusercontent.com/maps/google.com/3",
Â  Â  Â  Â "":{phone:"0567863628",location:"http://googleusercontent.com/maps/google.com/0"}
Â  Â  }[resortKeyForInfo];Â 
Â  Â  Â Â 
Â  Â  // 5. Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø±Ø§Ø¨Ø·
Â  Â  const params = new URLSearchParams();
Â  Â  params.append('action', 'TEMPLATE');
Â  Â  params.append('text', title);
    // === (ØªØ¹Ø¯ÙŠÙ„) Ø§Ø³ØªØ®Ø¯Ø§Ù… ØµÙŠØºØ© Ø§Ù„ÙŠÙˆÙ… Ø§Ù„ÙƒØ§Ù…Ù„ ===
Â  Â  params.append('dates', `${startDateString}/${endDateString}`);Â 
Â  Â  params.append('details', details);
Â  Â  params.append('location', resortLocation);
Â  Â  params.append('sf', 'true');
Â  Â  params.append('output', 'chrome');
    // === (ØªØ¹Ø¯ÙŠÙ„) Ø¥Ø¹Ø§Ø¯Ø© "trp=0" Ù„Ø¬Ø¹Ù„ Ø§Ù„ÙŠÙˆÙ… Ø§Ù„ÙƒØ§Ù…Ù„ "Ù…Ø´ØºÙˆÙ„" ===
    params.append('trp', '0'); // 0 = Busy, 1 = Free

Â  Â  const googleCalendarUrl = `https://www.google.com/calendar/render?${params.toString()}`;

Â  Â  // 6. ÙØªØ­ Ø§Ù„Ø±Ø§Ø¨Ø· ÙÙŠ Ù†Ø§ÙØ°Ø© Ø¬Ø¯ÙŠØ¯Ø©
Â  Â  window.open(googleCalendarUrl, '_blank');
Â  };
</script>
</body>

</html>
